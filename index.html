<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0ea5e9" />
  <title>스승님 X 서수연 프로 숏게임 클래스</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />

  <style>
    body{
      font-family:"Pretendard",-apple-system,BlinkMacSystemFont,system-ui,Roboto,"Helvetica Neue","Segoe UI","Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",sans-serif;
      background-color:#f8fafc;overflow-x:hidden;
    }
    .card-ratio{aspect-ratio:4/5;}
    @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-10px)}100%{transform:translateY(0)}}
    .animate-float{animation:float 3s ease-in-out infinite;}
    .safe-bottom{padding-bottom:calc(1rem + env(safe-area-inset-bottom));}
    .fixed-cta-wrap{bottom:calc(0rem + env(safe-area-inset-bottom));}
  </style>

  <script type="importmap">
  {
    "imports": {
      "@google/genai": "https://esm.sh/@google/genai@1.40.0",
      "react": "https://esm.sh/react@19.2.0",
      "react-dom/client": "https://esm.sh/react-dom@19.2.0/client"
    }
  }
  </script>
</head>

<body>
  <div id="root"></div>

  <script type="module">
    import React, { useCallback, useEffect, useMemo, useState } from "react";
    import { createRoot } from "react-dom/client";
    import { GoogleGenAI } from "@google/genai";

    const GEMINI_API_KEY = "";
    const KAKAO_APPLY_URL = "https://pf.kakao.com";
    const COLORS = { primary: "#0ea5e9", secondary: "#f5f5f4", accent: "#ffffff", text: "#1e293b" };

    const CARD_PAGES = [
      {
        id: 1,
        title: "숏게임만 잡아도\n10타는 줄일 수 있습니다",
        subtitle: "2026 시즌 대비",
        description: ["스승님 X 서수연 프로"],
        sceneDescription: "Extremely bright and clear blue sky. A cute 3D character (Seo Su-yeon) celebrating a successful putt on a lush green green. A stylish white golf cart in the background. High-quality 3D render, vibrant and energetic golf season vibe. Cinematic lighting.",
        bgType: "sky"
      },
      {
        id: 2,
        title: "드라이버 잘 쳐놓고\n그린 주변에서 까먹는 스코어..",
        subtitle: "너무 열받지 않으세요?",
        description: ["숏게임 하나로 5타 이상 줄일 수 있습니다.", "연습장에서는 프로, 필드에서는 백돌이."],
        sceneDescription: "An amateur golfer character furious while looking at a golf ball stopped right next to the hole cup. Next to him, a kind female Korean golf pro character (Seo Su-yeon) explains calmly. Lush green, detailed grass, cinematic sunlight.",
        bgType: "green"
      },
      {
        id: 3,
        title: "서수연 프로 숏게임 클래스",
        subtitle: "실전만 집중하는 2시간",
        description: ["어프로치 · 벙커 · 퍼팅"],
        sceneDescription: "A professional short game practice zone. Seo Su-yeon (cute 3D Korean female golf pro) is hands-on coaching a student’s posture for wedge shots. High-end practice area, clean vibrant 3D render, sunny blue sky.",
        bgType: "practice"
      },
      {
        id: 4,
        title: "레슨 특징",
        description: ["✔ 이론 최소", "✔ 실전 집중", "✔ 소수정예 단독", "✔ 날짜 직접 선택"],
        sceneDescription: "Outdoor coaching scene: a whiteboard on the green with golf ball trajectory arrows. Seo Su-yeon points with a club and teaches passionately. Bright sky, clean modern 3D style, no text in the image.",
        bgType: "green"
      },
      {
        id: 5,
        title: "특별 혜택",
        description: ["숏게임 레슨 15% 할인", "2인 동반 시 연습장비 50% 지원", "(연습장비 최대 2만원 / 조건별 적용)"],
        sceneDescription: "Floating shiny golden coins, discount coupon icons, and a 50% support icon in the foreground. Background is a golf practice range entrance, slightly blurred. Vibrant sky blue + gold theme, glossy 3D startup ad style.",
        bgType: "sky"
      },
      {
        id: 6,
        title: "이런 분께 추천합니다",
        description: ["• 시즌 첫 라운딩 준비 중", "• 숏게임 때문에 점수 안 줄어드는 분", "• 연습장과 필드 차이 느끼는 분", "• 친구와 같이 배우고 싶은 분"],
        sceneDescription: "A lineup of cute 3D amateur golfer characters (male/female) with different 고민 vibes, with simple icon speech bubbles. Seo Su-yeon stands smiling confidently. Sunny green, friendly clean style, no text in the image.",
        bgType: "green"
      },
      {
        id: 7,
        title: "신청 방법",
        description: ["하단 [신청하기] 버튼 클릭 →", "카카오톡 채널 채팅으로 바로 연결", "원하시는 날짜 말씀 주시면", "레슨 일정 바로 잡아드립니다."],
        sceneDescription: "Blurred KakaoTalk chat UI style background (no readable text). A cute 3D character touches a smartphone screen to apply. Behind the phone is a sunny golf course. Clean 3D render, no real photos, no text.",
        bgType: "chat"
      },
      {
        id: 8,
        title: "지금 바로 신청하세요",
        subtitle: "숏게임이 바뀌면 골프가 달라집니다.",
        description: [],
        sceneDescription: "A golf ball dropping into the hole at the decisive moment. Sparkling sunlight on the green grass. Wide panoramic beautiful golf course under a bright sky with warm sunset tint. Cinematic 3D render, no text.",
        bgType: "sky",
        isCTA: true
      }
    ];

    const sleep = (ms) => new Promise((r) => setTimeout(r, ms));

    async function generateCardImage(sceneDescription) {
      if (!GEMINI_API_KEY) return null;

      const ai = new GoogleGenAI({ apiKey: GEMINI_API_KEY });

      const prompt = `
High-quality 3D render illustration, modern startup advertising style.
Scene: ${sceneDescription}
Characters: Cute rounded 3D characters, big heads, expressive faces.
Seo Su-yeon Character: Beautiful Korean female golf pro, slim, wearing stylish golf wear (cap, skirt), bright smile, confident.
Environment: Bright blue sky, lush green golf course, no indoor offices.
Art style: Clean, vibrant colors, soft shadows, mobile poster composition.
Strict: No text in the image, no real photos, no app mockups, no logos.
      `.trim();

      let attempt = 0;
      const maxRetries = 3;

      while (attempt <= maxRetries) {
        try {
          const response = await ai.models.generateContent({
            model: "gemini-2.5-flash-image",
            contents: [{ parts: [{ text: prompt }] }],
            config: {
              imageConfig: { aspectRatio: "4:5" }
            }
          });

          const parts = response?.candidates?.[0]?.content?.parts || [];
          for (const part of parts) {
            if (part?.inlineData?.data) return `data:image/png;base64,${part.inlineData.data}`;
          }
          return null;
        } catch (e) {
          attempt++;
          const s = JSON.stringify(e || {});
          const is429 = s.includes("429") || String(e?.message || "").includes("429") || e?.status === 429;
          if (is429 && attempt <= maxRetries) {
            await sleep(Math.pow(2, attempt) * 800);
            continue;
          }
          console.error(e);
          return null;
        }
      }
      return null;
    }

    function Card({ page, imageUrl, isLoading, onRegenerate }) {
      return (
        React.createElement("div", { className: "relative w-full max-w-[400px] card-ratio bg-white shadow-xl rounded-3xl overflow-hidden flex-shrink-0 snap-center border-4 border-white mb-8 group" },
          React.createElement("div", { className: "absolute inset-0 z-0" },
            isLoading ? (
              React.createElement("div", { className: "w-full h-full bg-sky-50 flex flex-col items-center justify-center animate-pulse" },
                React.createElement("div", { className: "w-12 h-12 border-4 border-sky-400 border-t-transparent rounded-full animate-spin mb-4" }),
                React.createElement("p", { className: "text-sky-600 font-medium" }, "새로운 장면 생성 중...")
              )
            ) : imageUrl ? (
              React.createElement("img", { src: imageUrl, alt: page.title, className: "w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" })
            ) : (
              React.createElement("div", { className: "w-full h-full bg-sky-100 flex flex-col items-center justify-center px-6 text-center" },
                React.createElement("p", { className: "text-sky-500 font-black text-sm mb-2" }, "이미지를 생성할 수 없습니다"),
                React.createElement("p", { className: "text-sky-500/70 text-xs font-semibold leading-relaxed whitespace-pre-wrap" },
                  GEMINI_API_KEY ? "쿼터/권한/네트워크 오류일 수 있습니다.\n좌측 상단 버튼으로 다시 시도하세요." : "현재 API 키가 비어 있습니다.\nHTML 상단의 GEMINI_API_KEY 값을 설정해야 생성됩니다."
                )
              )
            ),
            React.createElement("div", { className: "absolute inset-0 bg-gradient-to-b from-black/40 via-transparent to-black/70" })
          ),

          React.createElement("div", { className: "absolute inset-0 z-10 p-8 flex flex-col justify-between text-white pointer-events-none" },
            React.createElement("div", null,
              page.subtitle ? React.createElement("span", { className: "inline-block bg-sky-500/90 px-3 py-1 rounded-full text-xs font-bold mb-3 tracking-wider drop-shadow-md" }, page.subtitle) : null,
              React.createElement("h2", { className: "text-2xl md:text-3xl font-extrabold leading-tight whitespace-pre-wrap drop-shadow-lg" }, page.title)
            ),
            React.createElement("div", { className: "space-y-2" },
              (page.description || []).map((line, idx) => (
                React.createElement("p", {
                  key: idx,
                  className: `text-lg font-semibold drop-shadow-md ${String(line).includes("✔") ? "text-sky-300" : ""}`
                }, line)
              ))
            )
          ),

          React.createElement("div", { className: "absolute top-4 right-4 z-20 bg-black/40 px-2 py-1 rounded text-[10px] font-bold text-white" },
            `${page.id} / ${CARD_PAGES.length}`
          ),

          !isLoading && React.createElement("button", {
            onClick: (e) => { e.stopPropagation(); onRegenerate(); },
            className: "absolute top-4 left-4 z-20 bg-white/20 hover:bg-white/40 backdrop-blur-md p-2 rounded-full transition-all active:rotate-180 duration-300 border border-white/30",
            title: "이미지 다시 만들기"
          },
            React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-4 w-4 text-white", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
              React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 3, d: "M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" })
            )
          )
        )
      );
    }

    function App() {
      const [images, setImages] = useState({});
      const [loadingIds, setLoadingIds] = useState(() => new Set());
      const [bootLoading, setBootLoading] = useState(true);

      const handleRegenerate = useCallback(async (pageId) => {
        const page = CARD_PAGES.find((p) => p.id === pageId);
        if (!page) return;

        setLoadingIds((prev) => {
          const next = new Set(prev);
          next.add(pageId);
          return next;
        });

        setImages((prev) => {
          const next = { ...prev };
          delete next[pageId];
          return next;
        });

        try {
          const url = await generateCardImage(page.sceneDescription);
          if (url) setImages((prev) => ({ ...prev, [pageId]: url }));
        } finally {
          setLoadingIds((prev) => {
            const next = new Set(prev);
            next.delete(pageId);
            return next;
          });
        }
      }, []);

      const fetchImages = useCallback(async () => {
        setBootLoading(true);
        for (const page of CARD_PAGES) {
          await handleRegenerate(page.id);
          await sleep(450);
        }
        setBootLoading(false);
      }, [handleRegenerate]);

      useEffect(() => { fetchImages(); }, [fetchImages]);

      const handleApply = () => { window.location.href = KAKAO_APPLY_URL; };

      const allLoadedCount = useMemo(() => Object.keys(images).length, [images]);
      const progress = useMemo(() => Math.round((allLoadedCount / CARD_PAGES.length) * 100), [allLoadedCount]);

      return (
        React.createElement("div", { className: "min-h-screen bg-sky-50 flex flex-col items-center" },
          React.createElement("header", { className: "w-full bg-white/80 backdrop-blur-md py-4 px-6 sticky top-0 z-50 flex justify-between items-center shadow-sm" },
            React.createElement("div", { className: "flex items-center gap-3" },
              React.createElement("h1", { className: "text-sky-600 font-black text-xl italic tracking-tighter" }, "스승님 X 서수연"),
              React.createElement("span", { className: "text-[10px] text-gray-500 font-medium" }, "2026 Short Game Class")
            ),
            React.createElement("div", { className: "flex items-center gap-2" },
              React.createElement("div", { className: "text-[10px] text-gray-500 font-bold" }, `${progress}%`),
              React.createElement("button", {
                onClick: fetchImages,
                className: "text-[11px] font-black px-3 py-2 rounded-xl bg-sky-100 text-sky-700 hover:bg-sky-200 active:scale-95 transition"
              }, "전체 재생성")
            )
          ),

          React.createElement("main", { className: "w-full max-w-lg px-4 pt-8 pb-32 flex flex-col items-center gap-4 safe-bottom" },
            CARD_PAGES.map((page) => (
              React.createElement(Card, {
                key: page.id,
                page,
                imageUrl: images[page.id] || null,
                isLoading: loadingIds.has(page.id),
                onRegenerate: () => handleRegenerate(page.id)
              })
            ))
          ),

          React.createElement("div", { className: "fixed bottom-0 left-0 w-full p-4 bg-gradient-to-t from-white via-white/90 to-transparent z-50 fixed-cta-wrap" },
            React.createElement("div", { className: "max-w-md mx-auto" },
              React.createElement("button", {
                onClick: handleApply,
                className: "w-full py-4 bg-sky-500 hover:bg-sky-600 active:scale-95 transition-all text-white font-black text-xl rounded-2xl shadow-xl shadow-sky-200 flex items-center justify-center gap-2 group"
              },
                "숏게임 클래스 신청하기",
                React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6 group-hover:translate-x-1 transition-transform", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
                  React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 3, d: "M13 7l5 5m0 0l-5 5m5-5H6" })
                )
              ),
              React.createElement("p", { className: "text-center text-[10px] text-gray-400 mt-2 font-medium" },
                "버튼 클릭 시 카카오톡 채널 상담으로 연결됩니다."
              )
            )
          )
        )
      );
    }

    createRoot(document.getElementById("root")).render(
      React.createElement(React.StrictMode, null, React.createElement(App))
    );
  </script>
</body>
</html>


